<script type="text/javascript">
	function onLoad(){
			document.getElementById("docxTemplateInput").addEventListener("change", readTemplateFile);
	}
	
	readTemplateFile = function(evt) {
		var f = evt.target.files[0];

		if (f) {
			var r = new FileReader();
			r.onload = function(e) {
				var contents = e.target.result;
				doc = new window.Docxgen(contents);
				var text = document.getElementById("templateText").value;
				//var data = JSON.parse(text);
                doc.setData({
                    "direction" : "Информатика и вычислительная техника",
                    "profile" : "Программное обеспечение вычислительной техники и автоматизированных систем",
                    "type_practice" : "учебная",
                    "start_date" : "5.02.18",
                    "end_date" : "08.06.18",
                    "group_name" : "17-ИВТ2",
                    "supervisor" : "ассистент Радченко Алексей Олегович",
                    "head_of_department" : "Подвесовский А.Г.",
                    "dean" : "Дергачев К.В",
                    "students": [{
                        "name":"DukSoftware"
                    },{
                        "name":"Tingerlee"
                    }]});
				doc.render() //apply them (replace all occurences of {first_name} by Hipp, ...)
				out = doc.getZip().generate({
					type : "blob"
				});
				saveAs(out, "output.docx")
			};
			r.readAsBinaryString(f);
		} else {
			alert("Failed to load file");
		}
	};
	</script>